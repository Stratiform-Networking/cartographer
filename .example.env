# ─────────────────────────────────────────────────────────────────────────────
# Cartographer Environment Configuration
# Copy this file to .env and fill in your values
# ─────────────────────────────────────────────────────────────────────────────

# =============================================================================
# SECURITY (Required for production!)
# =============================================================================

# Secret key for authentication tokens - SET THIS VALUE!
# Generate one with: openssl rand -hex 32
JWT_SECRET=

# =============================================================================
# DATABASE
# =============================================================================

# PostgreSQL info - SET THE PASSWORD VALUE!
# Generate one with: openssl rand -base64 32
POSTGRES_USER=cartographer
POSTGRES_PASSWORD=
POSTGRES_DB=cartographer

# Database URL (constructed automatically in docker-compose, only set for custom deployments)
# DATABASE_URL=postgresql+asyncpg://cartographer:cartographer_secret@localhost:5432/cartographer

# =============================================================================
# AI ASSISTANT
# Configure at least one provider to enable the AI assistant
# =============================================================================

# OpenAI (GPT-4, GPT-3.5, etc.)
# Get your key at: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# Anthropic (Claude)
# Get your key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=

# Google Gemini
# Get your key at: https://makersuite.google.com/app/apikey
GOOGLE_API_KEY=
# Alternative variable name (either works)
GEMINI_API_KEY=

# Ollama (Free, runs locally - no API key needed!)
# Just install Ollama from https://ollama.ai and run it
# Default assumes Ollama is running on the same machine
OLLAMA_HOST=http://localhost:11434

# Limit for the number of assistant messages per day per user
ASSISTANT_CHAT_LIMIT_PER_DAY=9999

# Users which are able to override the daily limit (unlimited assistant requests)
ASSISTANT_RATE_LIMIT_EXEMPT_ROLES="admin,owner"

# Maximum number of networks a user can create (default: 1)
# Admins can set custom limits per-user via the API
NETWORK_LIMIT_PER_USER=1

# Roles that have unlimited networks (comma-separated)
NETWORK_LIMIT_EXEMPT_ROLES="admin,owner"

# Custom message shown when network limit is reached
# Use {limit} as placeholder for the user's limit number
# Leave empty for default: "You've reached your network limit ({limit}). Contact an administrator to increase your limit."
NETWORK_LIMIT_MESSAGE=

# Your application URL (used for production apps)
# For local dev: use frontend port (5173). For production: your domain.
APPLICATION_URL=http://localhost:5173

# =============================================================================
# EMAIL INVITATIONS (Optional)
# Enable email delivery for user invitations
# =============================================================================

# Resend API key for sending invitation emails
# Get your key at: https://resend.com/
# If not set, invitations still work - users just get a link to share manually
RESEND_API_KEY=

# The "from" address for invitation emails
EMAIL_FROM="Cartographer <noreply@yourdomain.com>"

# How long invitation links remain valid (in hours)
INVITE_EXPIRATION_HOURS=72

# =============================================================================
# ADVANCED SETTINGS
# Most users won't need to change these
# =============================================================================

# Disable FastAPI documentation endpoints (/docs, /redoc, /openapi.json)
# Set to "true" to disable - useful for production deployments
# Default: false (docs are enabled)
DISABLE_DOCS=false

# How often to refresh network metrics (in seconds)
METRICS_PUBLISH_INTERVAL=30

# Redis connection (only change if running Redis elsewhere)
REDIS_URL=redis://localhost:6379
REDIS_DB=0

# Service URLs (only change for custom deployments)
HEALTH_SERVICE_URL=http://localhost:8001
AUTH_SERVICE_URL=http://localhost:8002
METRICS_SERVICE_URL=http://localhost:8003
ASSISTANT_SERVICE_URL=http://localhost:8004
NOTIFICATION_SERVICE_URL=http://localhost:8005
BACKEND_SERVICE_URL=http://localhost:8000

# CORS origins (comma-separated, use * for development)
CORS_ORIGINS=*

# Cookie-backed browser session + CSRF
# Set to true in production (false is fine for local HTTP development)
AUTH_COOKIE_NAME=cartographer_session
CSRF_COOKIE_NAME=cartographer_csrf
AUTH_COOKIE_SECURE=false
AUTH_COOKIE_SAMESITE=lax
AUTH_COOKIE_PATH=/
# Comma-separated origins for CSRF origin/referer validation (defaults to CORS_ORIGINS without *)
CSRF_TRUSTED_ORIGINS=

# Environment mode: development (default) or production
# Production mode enforces stricter security validations
ENV=development

# =============================================================================
# AUTHENTICATION PROVIDER
# Choose between local auth (default) or cloud auth (Clerk)
# =============================================================================

# Auth provider mode: "local" (default) or "cloud"
# - local: Self-hosted auth with bcrypt passwords and JWT tokens
# - cloud: Clerk-based auth with social login support (Google, etc.)
AUTH_PROVIDER=local

# Enable open registration (only applies to local auth)
# If true, users can register without an invitation
ALLOW_OPEN_REGISTRATION=false

# Clerk settings (only required when AUTH_PROVIDER=cloud)
# Get your keys at: https://dashboard.clerk.com/
CLERK_PUBLISHABLE_KEY=
CLERK_SECRET_KEY=
CLERK_WEBHOOK_SECRET=
